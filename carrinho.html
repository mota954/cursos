<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Carrinho de Compras</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #f0f8ff, #ffffff);
      font-family: 'Roboto', sans-serif;
      animation: fundoAnimado 10s ease infinite alternate;
    }

    @keyframes fundoAnimado {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }

    .carrinho-container {
      max-width: 900px;
      margin: 60px auto;
      background: white;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      text-align: center;
      position: relative;
    }

    .icone-carrinho {
      font-size: 3em;
      color: #007bff;
      margin-bottom: 10px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .carrinho-container h2 {
      color: #007bff;
      font-size: 2em;
      margin-bottom: 30px;
    }

    .curso-lista {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      margin-bottom: 30px;
    }

    .curso-card {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.1);
      width: 240px;
      transition: transform 0.3s ease;
      position: relative;
      transform: translateY(0);
    }

    .curso-card:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 0 25px rgba(0,123,255,0.3);
    }

    .curso-card h3 {
      margin-bottom: 10px;
      font-size: 1.1em;
      color: #333;
    }

    .curso-card p {
      font-size: 0.95em;
      color: #555;
      margin-bottom: 5px;
    }

    .remover {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 50%;
      width: 25px;
      height: 25px;
      font-size: 0.9em;
      cursor: pointer;
    }

    .finalizar {
      padding: 12px 30px;
      background: #28a745;
      color: white;
      border-radius: 30px;
      font-weight: bold;
      text-decoration: none;
      transition: background 0.3s ease;
      border: none;
      cursor: pointer;
      font-size: 1em;
      margin-top: 20px;
      position: relative;
      overflow: hidden;
    }

    .finalizar::after {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(120deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.6s ease;
    }

    .finalizar:hover::after {
      left: 100%;
    }

    .finalizar:hover {
      background: #218838;
    }

    .vazio {
      color: #888;
      font-size: 1em;
      margin-top: 20px;
    }

    .total {
      font-size: 1.2em;
      font-weight: bold;
      color: #333;
      margin-top: 10px;
    }

    .modal-sucesso {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #28a745;
      color: white;
      padding: 20px 40px;
      border-radius: 12px;
      font-size: 1.2em;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
      animation: fadeIn 0.8s ease forwards;
      z-index: 999;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translate(-50%, -60%); }
      to { opacity: 1; transform: translate(-50%, -50%); }
    }

    @media (max-width: 768px) {
      .curso-lista {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>

  <div class="carrinho-container" data-aos="fade-up">
    <div class="icone-carrinho"><i class="fas fa-shopping-cart"></i></div>
    <h2>Seu Carrinho de Compras</h2>
    <div class="curso-lista" id="listaCarrinho"></div>
    <p class="vazio" id="mensagemVazio">Nenhum curso no carrinho.</p>
    <p class="total" id="valorTotal"></p>
    <button class="finalizar" id="btnFinalizar">Finalizar compra</button>
  </div>

  <div id="modalSucesso" class="modal-sucesso">âœ… Compra finalizada com sucesso!</div>

  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script>
    AOS.init({ duration: 1000, once: true });

    const nomes = {
      programacao: "ðŸ’» ProgramaÃ§Ã£o",
      marketing: "ðŸ“¢ Marketing",
      economia: "ðŸ“Š Economia",
      contabilidade: "ðŸ“˜ Contabilidade",
      administracao: "ðŸ¢ AdministraÃ§Ã£o",
      vendas: "ðŸ›’ GestÃ£o de Vendas",
      pessoas: "ðŸ‘¥ GestÃ£o de Pessoas",
      financas: "ðŸ’° FinanÃ§as"
    };

    const precos = {
      programacao: 29.99,
      marketing: 18.90,
      economia: 29.90,
      contabilidade: 29.90,
      administracao: 29.99,
      vendas: 29.99,
      pessoas: 15.90,
      financas: 15.90
    };

    const email = localStorage.getItem("usuarioLogado");
    if (!email) {
      alert("VocÃª precisa estar cadastrado para acessar o carrinho.");
      window.location.href = "acesso.html";
    }

    const usuarios = JSON.parse(localStorage.getItem("usuarios")) || {};
    if (!usuarios[email]) {
      usuarios[email] = { nome: "Aluno", cursosComprados: [], carrinho: [] };
    }

    let carrinho = usuarios[email].carrinho || [];

    const lista = document.getElementById("listaCarrinho");
    const vazio = document.getElementById("mensagemVazio");
    const btnFinalizar = document.getElementById("btnFinalizar");
    const valorTotal = document.getElementById("valorTotal");
    const modalSucesso = document.getElementById("modalSucesso");

    function renderizarCarrinho() {
      lista.innerHTML = "";
      let total = 0;

      if (carrinho.length === 0) {
        vazio.style.display = "block";
        btnFinalizar.style.display = "none";
        valorTotal.innerText = "";
        return;
      }

      vazio.style.display = "none";
      btnFinalizar.style.display = "inline-block";

      carrinho.forEach((curso, index) => {
        const card = document.createElement("div");
        card.className = "curso-card";
        card.setAttribute("data-aos", "zoom-in");
        card.innerHTML = `
          <button class="remover" onclick="removerCurso(${index})">&times;</button>
          <h3>${nomes[curso]}</h3>
                    <p>Valor: R$ ${precos[curso].toFixed(2)}</p>
        `;
        lista.appendChild(card);
        total += precos[curso];
      });

      valorTotal.innerText = `Valor total: R$ ${total.toFixed(2)}`;
    }

    function removerCurso(index) {
      carrinho.splice(index, 1);
      usuarios[email].carrinho = carrinho;
      localStorage.setItem("usuarios", JSON.stringify(usuarios));
      renderizarCarrinho();
    }

    btnFinalizar.addEventListener("click", () => {
      const comprados = usuarios[email].cursosComprados || [];

      carrinho.forEach(curso => {
        if (!comprados.includes(curso)) {
          comprados.push(curso);
        }
      });

      usuarios[email].cursosComprados = comprados;
      usuarios[email].carrinho = [];
      localStorage.setItem("usuarios", JSON.stringify(usuarios));

      // Exibe modal de sucesso com animaÃ§Ã£o
      modalSucesso.style.display = "block";

      // Redireciona apÃ³s 2 segundos
      setTimeout(() => {
        modalSucesso.style.display = "none";
        window.location.href = "aluno.html";
      }, 2000);
    });

    renderizarCarrinho();
  </script>

</body>
</html>
